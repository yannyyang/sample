/*! PALifeOpen ,version:1.2.0, Thu Feb 23 2017 16:57:01 GMT+0800 (CST) */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PALifeOpen=t():e.PALifeOpen=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(1);e.exports=new r.Open},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Open=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),a=new o.JSSDK,c=function(){},s=void 0,u=void 0,v=function(){a.createJsAction({service:"webview",action:"goBack",handler:function(e,t){var n=!0;"function"==typeof s&&(n=s.call(null),!0!==n&&(n=!1)),t({ret:0,msg:"success",data:{appGoBack:n}})}})},l=function(){a.createJsAction({service:"webview",action:"onNavRightBtn",handler:function(e,t){"function"==typeof u&&u.call(null),t({ret:0,msg:"success"})}})};t.Open=function(){function e(){r(this,e)}return i(e,[{key:"config",value:function(e,t,n){e=e||{};var r=e.goBack,i=e.rightBtn;v(),this.setGoBack({goBack:r}),l(),this.setRightBtn(i),a.start(c,t,n,{appId:e.appId,timestamp:e.timestamp,signature:e.signature})}},{key:"debug",value:function(){window._PALifeBridge_debug=!0}},{key:"getCV",value:function(){var e=window.navigator.userAgent.match(/PARS\/([\d.]+)/);return e&&e.length>0?~~e[1]:0}},{key:"setGoBack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.goBack;return t?"function"!=typeof t?void console.error("参数的goBack属性类型错误. 类型必须为function"):void(s=t):void console.error("参数缺少goBack属性")}},{key:"setRightBtn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title;if(null==t)return void console.error("参数缺少title属性");a.native({service:"webview",action:"setNavRightBtn",param:{type:"text",title:e.title}});var n=e.onCallFunction;return n?"function"!=typeof n?void console.error("参数的onCallFunction属性类型错误. 类型必须为function"):void(u=n):void console.error("参数缺少onCallFunction属性")}},{key:"setTitle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(arguments[1],arguments[2],e.title);return t?"string"!=typeof t?void console.error("PALifeOpen.setTitle()参数title，类型错误. 参数类型必须为string"):void a.native({service:"webview",action:"setWebViewTitle",param:{title:t}}):void console.error("PALifeOpen.setTitle()参数，缺少title")}},{key:"getDeviceId",value:function(e,t){a.native({service:"device",action:"getDeviceId",param:{},options:{timeout:864e5},success:e,error:t})}},{key:"getOpenId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=e.appId;return r?"string"!=typeof r?void console.error("PALifeOpen.getOpenId()参数appId，类型错误. 参数类型必须为string"):void a.native({service:"papay",action:"getOpenId",param:{appId:r},options:{timeout:864e5},success:t,error:n}):void console.error("PALifeOpen.getOpenId()参数，缺少appId")}},{key:"canUpgradeMainAccount",value:function(e,t){a.native({service:"wangcai",action:"canUpgradeMainAccount",options:{timeout:864e5},success:e,error:t})}},{key:"openWangCaiAccount",value:function(e,t){a.native({service:"wangcai",action:"openWangCaiAccount",options:{timeout:864e5},success:e,error:t})}},{key:"wangCaiBindCard",value:function(e,t){a.native({service:"wangcai",action:"bindCard",options:{timeout:864e5},success:e,error:t})}},{key:"wcPay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=e.appId,i=e.openId;return r?"string"!=typeof r?void console.error("PALifeOpen.wcPay()参数appId，类型错误. 参数类型必须为string"):i?"string"!=typeof i?void console.error("PALifeOpen.wcPay()参数openId，类型错误. 参数类型必须为string"):void a.native({service:"papay",action:"wcPay",param:e,options:{timeout:864e5},success:t,error:n}):void console.error("PALifeOpen.wcPay()参数，缺少openId"):void console.error("PALifeOpen.wcPay()参数，缺少appId")}},{key:"verifyPayPwd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=e.appId,i=e.openId;return r?"string"!=typeof r?void console.error("PALifeOpen.verifyPayPwd()参数appId，类型错误. 参数类型必须为string"):i?"string"!=typeof i?void console.error("PALifeOpen.verifyPayPwd()参数openId，类型错误. 参数类型必须为string"):void a.native({service:"papay",action:"verifyPayPwd",param:e,options:{timeout:864e5},success:t,error:n}):void console.error("PALifeOpen.verifyPayPwd()参数，缺少openId"):void console.error("PALifeOpen.verifyPayPwd()参数，缺少appId")}},{key:"openStockAccount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=e.openId;return r?"string"!=typeof r?void console.error("PALifeOpen.openStockAccount()参数openId，类型错误. 参数类型必须为string"):void a.native({service:"stock",action:"openAccount",param:e,options:{timeout:864e5},success:t,error:n}):void console.error("PALifeOpen.openStockAccount()参数，缺少openId")}},{key:"trackEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=e.event,i=e.label;return r?"string"!=typeof r?void console.error("PALifeOpen.trackEvent()参数event，类型错误. 参数类型必须为string"):i?"string"!=typeof i?void console.error("PALifeOpen.trackEvent()参数label，类型错误. 参数类型必须为string"):void a.native({service:"common",action:"trackEvent",param:e,options:{timeout:864e5},success:t,error:n}):void console.error("PALifeOpen.trackEvent()参数，缺少label"):void console.error("PALifeOpen.trackEvent()参数，缺少event")}},{key:"share",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2];e.shareTypes=e.shareTypes||"WXHY|WXPYQ|XLWB|DX",a.native({service:"webview",action:"share",param:e,options:{timeout:864e5},success:t,error:n})}},{key:"bindCreditCardSuccess",value:function(e,t){a.native({service:"wangcai",action:"bindCreditCardSuccess",options:{timeout:864e5},success:e,error:t})}},{key:"bindCreditCardFailed",value:function(e,t){a.native({service:"wangcai",action:"bindCreditCardFailed",options:{timeout:864e5},success:e,error:t})}},{key:"invoke",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3],i=arguments[4],o=arguments[5];return"string"!=typeof e?void console.error("PALifeOpen.invoke()参数 service ，类型错误. 参数类型必须为 string"):"string"!=typeof t?void console.error("PALifeOpen.invoke()参数 action ，类型错误. 参数类型必须为 string"):void a.native({service:e,action:t,param:n,options:o,success:r,error:i})}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.JSSDK=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4),a=n(5),c=n(3);t.JSSDK=function(){function e(){r(this,e),this.status=o.JSSDK_STATUS.NOT_READY,this.callbackList=[],this.preJsServiceContainer=new c.PreJsServiceContainer,this.jsService={}}return i(e,[{key:"start",value:function(e,t,n,r){var i=this,a=e||o.nope;if(t=t||o.nope,n=n||o.nope,"function"!=typeof a)throw new Error("start param must be a function!");a.call(null);var c=function(e){i.bridge=e,e.registerNativeService(o.defaultNativeServices),e.registerJsService(i.preJsServiceContainer.getPlainJsServices()),r=r||{};var a={webServiceList:e.getJsServiceJSON()};null!=r.appId&&(a.appId=r.appId),null!=r.timestamp&&(a.timestamp=r.timestamp),null!=r.signature&&(a.signature=r.signature),e.sendMessageToNative("bridge","configSDK",a,function(e){if(e&&"0"===e.ret)if(e.data&&e.data.nativeServiceList){var r=e.data.nativeServiceList,a=i.covertOriginNativeSerivceStructure(r);i.bridge.registerNativeService(a),i.invokeCallbackList(),i.status=o.JSSDK_STATUS.READY,t.call(null)}else console.error("nativeServiceList is empty!!!",e),n.call(null,e),i.status=o.JSSDK_STATUS.ERROR;else console.error("invoke service[bridge:configSDK] occur an Error",e),n.call(null,e),i.status=o.JSSDK_STATUS.ERROR},function(e){console.error("invoke service[bridge:configSDK] occur an Error",e),n.call(null,e),i.status=o.JSSDK_STATUS.ERROR})},s=window[o.BRIDGE_NAME];s?c(s):document.addEventListener(o.BRIDGE_LOAD_FINISH_EVENT,function(e){c(e.data)},!1)}},{key:"covertOriginNativeSerivceStructure",value:function(e){var t=[];if((0,a.isArray)(e))return e.forEach(function(e){var n=Object.create(e),r=[];e.actions.forEach(function(e){var t={};t.name=e,r.push(t)}),n.actions=r,t.push(n)}),t;throw new Error("srcServiceList must be a array")}},{key:"invokeCallbackList",value:function(){this.callbackList.forEach(function(e){e.call(null)}),this.callbackList=[]}},{key:"createJsAction",value:function(e){var t;if(this.status!==o.JSSDK_STATUS.NOT_READY)throw new Error('"JSSDK.createJsAction" must be invoked in the "JSSDK.start" callback function or before "JSSDK.start"!!');(t=this.preJsServiceContainer).addAction.apply(t,arguments)}},{key:"native",value:function(e){var t=this,n=e||{},r={success:o.nope,error:o.nope};n.success=e.success||r.success,n.error=e.error||r.error;var i=function(){for(var e=!1,r=t.bridge.getNativeServiceJSON()||[],i=0;i<r.length;i++){var o=r[i]||{};if(o.service===n.service){for(var a=o.actions||[],c=0;c<a.length;c++){var s=a[c]||{};if(s===n.action){e=!0;break}}break}}e?t.bridge.sendMessageToNative(n.service,n.action,n.param,n.success,n.error,n.options):(console.error("Can not find {service:"+n.service+", action:"+n.action+"}"),n.error.call(null,{errcode:"400",errmsg:"Can not find {service:"+n.service+", action:"+n.action+"}"}))};if(this.status===o.JSSDK_STATUS.NOT_READY)this.callbackList.push(i);else{if(this.status!==o.JSSDK_STATUS.READY)throw new Error("JSSDK occur an Error!!");i()}}},{key:"setScope",value:function(e){var t=this,n=e||{},r=n.service,i=n.action,a=n.self||{},c=function(){var e=t.bridge.getActionScope(r,i);for(var n in a)e[n]=a[n]};if(this.status===o.JSSDK_STATUS.NOT_READY)this.callbackList.push(c);else{if(this.status!==o.JSSDK_STATUS.READY)throw new Error("JSSDK occur an Error!!");c()}}},{key:"debug",value:function(){window._PALifeBridge_debug=!0}}]),e}()},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.PreJsServiceContainer=function(){function e(){n(this,e),this.list=[]}return r(e,[{key:"addAction",value:function(e){var t=e.service,n=this.getService(t),r={name:e.action,handler:e.handler,options:e.options};n.actions.push(r)}},{key:"getService",value:function(e){this.list.forEach(function(t){if(t.service===e)return t});var t={service:e,actions:[]};return this.list.push(t),t}},{key:"getPlainJsServices",value:function(){return this.list}}]),e}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultNativeServices=[{service:"bridge",actions:[{name:"configSDK",options:{timeout:5e3}}]}],t.JSSDK_STATUS={READY:1,NOT_READY:0,ERROR:1},t.BRIDGE_NAME="PALifeJSBridge",t.nope=function(){},t.BRIDGE_LOAD_FINISH_EVENT="_bridgeLoadFinishEvent"},function(e,t){"use strict";function n(e){return"[object Array]"===Object.prototype.toString.call(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isArray=n}])});